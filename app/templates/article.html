{% extends "base.html" %}
{% block content %}
<div class="card">
    {% if user and article.author and user.id == article.author.id %}
    <div class="article-actions-top">
        <a href="/article/{{ article.id }}/edit" class="action-link edit">✏️ 编辑</a>
        <span class="action-separator">|</span>
        <a href="#" onclick="deleteArticle({{ article.id }})" class="action-link delete">🗑️ 删除</a>
    </div>
    {% endif %}
    
    <h1>{{ article.title }}</h1>
    
    <div class="article-content">
        {{ article.content }}
    </div>
    
    <div class="article-meta right">
        {{ article.author.username if article.author else '匿名' }} • {{ article.created_at.strftime('%Y-%m-%d %H:%M') if article.created_at else '' }}
    </div>
</div>

<script>
function deleteArticle(articleId) {
    if (confirm('确定要删除这篇文章吗？')) {
        fetch(`/article/${articleId}/delete`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
        }).then(response => {
            if (response.ok) {
                window.location.href = '/';
            } else {
                alert('删除失败，请重试');
            }
        }).catch(error => {
            console.error('Error:', error);
            alert('删除失败，请重试');
        });
    }
}
</script>
{% endblock %}